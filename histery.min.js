/*!
 * Histery.js v0.7.5, https://github.com/hoho/histery
 * (c) 2013-2014 Marat Abdullin, MIT license
 */
!function(a,b,c,d){var e,f,g,h,i,j,k=a.history||{},l=[],m={},n=[],o=0,p=[],q={}.constructor,r=function(a){return"function"==typeof a},s=function(a){return"string"==typeof a},t=function(a){return a&&a.constructor===q},u=function(a,d){return d=b,a&&(d=c.createElement("a"),d.href=a),d=d.pathname+d.search+(d.hash.length>1?d.hash:""),"/"===d[0]?d:"/"+d},v=function(a,b,c,d,e){return b instanceof RegExp?(c=0,d=a.replace(b,function(){return c++,e=Array.prototype.slice.call(e=arguments,1,e.length-2),""})):r(b)?(c=1,e=b(a)):a===b&&(c=1,e=[]),1!==c||d?void 0:e},w=function(a,b,c,d,e){return a.replace(/^([^?#]+)(?:\?([^#]*))?(?:#(.*))?$/,function(a,b,f,g){c=b||"",d=f||"",e=g||""}),c&&(t(b)?(c=b.pathname?v(c,b.pathname):[],d=b.search?v(d,b.search):[],e=b.hash?v(e,b.hash):[]):(c=v(c,b),d=e=[]),c&&d&&e)?[a].concat(c,d,e):void 0},x=function(a,b,c,d,e){for(d=0;d<b.length;d++)e=b[d],e[0]===a&&c.push(e[1])},y=function(a,b){for(;b=a.shift();)b()},z=function(a,b,c,d){if(a=a||[],b=b||[],a.length!==b.length)d=!1;else for(d=!0,c=2;c<a.length;c++)if(!e.eq(a[c],b[c])){d=!1;break}return d};a.$H=e={state:function(a,b){return b===d?i[a]:(null===b?delete i[a]:i[a]=b,void(k.replaceState&&k.replaceState(i,null)))},run:function(){var a=c.createEvent("HTMLEvents"),f=function(a){("popstate"===a.type||j!==b.href)&&(h=!0,i=k.state||{},e.go()),j="popstate"===a.type?b.href:d};return addEventListener("popstate",f),addEventListener("hashchange",f),a.initEvent("popstate",!0,!1),dispatchEvent(a),e},go:function(a,c,e){var j,o,q,s,t=[],v=!1,A={},B=[],C=[];for(a=u(a),o=0;o<l.length;o++)f=l[o],(!(j=f.h)||(q=w(m[a]||a,j)))&&(j?A[o]=v=!0:q=[a],function(a,b){a.unshift(d),a[0]=z(f.cur,a),c||(f.cur=a);var e=f,g=!!j;r(b)&&(b=b()),b.go&&B.push([g,function(){b.go.apply(b,a)}]),b.leave&&C.push([g,function(){a[0]=z(e.cur,a),b.leave.apply(b,a)}])}(q,f.c));if(x(v,B,t),s=t.length>0,!c){for(j=0;j<l.length;j++)f=l[j],f.cur=v&&A[j]||!v&&!f.h?f.cur:null;for(y(p),x(v,C,p),g&&(k.pushState&&t.length?h||k[e?"replaceState":"pushState"](i={},null,a):b.href=a),g=!0,h=!1,y(t),j=0;j<n.length;j++)n[j](a)}return s},on:function(a,b){return a===d?n.push(b):(s(a)&&s(b)?m[u(a)]=u(b):l.push({h:a,c:b,cur:null}),a||o++),e},off:function(a,b){var c,f;if(s(a)&&s(b)&&m[c=u(a)]===u(b))delete m[c];else if(a===d)for(c=n.length;c--;)n[c]===b&&n.splice(c,1);else for(a||b||(l=[]),c=l.length;c--;)f=l[c],f.h!==a||b&&f.c!==b||(l.splice(c,1),f.h||o--);return e},eq:function A(a,b){var c,d,e;if(t(a)&&t(b)){c=[],d=[];for(e in a){if(!(e in b))return!1;c.push(e)}for(e in b){if(!(e in a))return!1;d.push(e)}if(c.length!==d.length)return!1;for(e=0;e<c.length;e++)if(!A(a[c[e]],b[c[e]]))return!1;return!0}if(a instanceof Array&&b instanceof Array&&a.length===b.length){for(e=a.length;e--;)if(!A(a[e],b[e]))return!1;return!0}return a===b}}}(window,location,document);