/*!
 * Histery.js v0.7.2, https://github.com/hoho/histery
 * (c) 2013-2014 Marat Abdullin, MIT license
 */
!function(a,b,c,d){var e,f,g,h,i,j,k=a.history||{},l=[],m=[],n=0,o=[],p={}.constructor,q=function(a){return"function"==typeof a},r=function(a){return a&&a.constructor===p},s=function(a,d){return d=b,a&&(d=c.createElement("a"),d.href=a),d=d.pathname+d.search+(d.hash.length>1?d.hash:""),"/"===d[0]?d:"/"+d},t=function(a,b,c,d,e){return b instanceof RegExp?(c=0,d=a.replace(b,function(){return c++,e=Array.prototype.slice.call(e=arguments,1,e.length-2),""})):q(b)?(c=1,e=b(a),!e||e instanceof Array||(e=[e])):a===b&&(c=1,e=[]),1!==c||d?void 0:e},u=function(a,b,c,d,e){return a.replace(/^([^?#]+)(?:\?([^#]*))?(?:#(.*))?$/,function(a,b,f,g){c=b||"",d=f||"",e=g||""}),c&&(r(b)?(c=b.pathname?t(c,b.pathname):[],d=b.search?t(d,b.search):[],e=b.hash?t(e,b.hash):[]):(c=t(c,b),d=e=[]),c&&d&&e)?[a].concat(c,d,e):void 0},v=function(a,b,c,d,e){for(d=0;d<b.length;d++)e=b[d],e[0]===a&&c.push(e[1])},w=function(a,b){for(;b=a.shift();)b()},x=function(a,b,c,d,e){if(r(a)&&r(b)){c=[],d=[];for(e in a){if(!(e in b))return!1;c.push(e)}for(e in b){if(!(e in a))return!1;d.push(e)}if(c.length!==d.length)return!1;for(e=0;e<c.length;e++)if(!x(a[c[e]],b[c[e]]))return!1;return!0}if(a instanceof Array&&b instanceof Array&&a.length===b.length){for(e=a.length;e--;)if(!x(a[e],b[e]))return!1;return!0}return a===b},y=function(a,b,c,d){if(a=a||[],b=b||[],a.length!==b.length)d=!1;else for(d=!0,c=2;c<a.length;c++)if(!x(a[c],b[c])){d=!1;break}return d};a.$H=e={state:function(a,b){return b===d?i[a]:(null===b?delete i[a]:i[a]=b,void(k.replaceState&&k.replaceState(i,null)))},run:function(){var a=c.createEvent("HTMLEvents"),f=function(a){("popstate"===a.type||j!==b.href)&&(h=!0,i=k.state||{},e.go()),j="popstate"===a.type?b.href:d};return addEventListener("popstate",f),addEventListener("hashchange",f),a.initEvent("popstate",!0,!1),dispatchEvent(a),e},go:function(a,c){var e,j,n,p,r=[],t=!1,x={},z=[],A=[];for(a=s(a),j=0;j<l.length;j++)f=l[j],(!f.h||(n=u(a,f.h)))&&(f.h?x[j]=t=!0:n=[a],function(a,b){a.unshift(d),a[0]=y(f.cur,a),c||(f.cur=a);var e=f,g=!!f.h;q(b)&&(b=b()),b.go&&z.push([g,function(){b.go.apply(b,a)}]),b.leave&&A.push([g,function(){a[0]=y(e.cur,a),b.leave.apply(b,a)}])}(n,f.c));if(v(t,z,r),p=r.length>0,!c){for(e=0;e<l.length;e++)f=l[e],f.cur=t&&x[e]||!t&&!f.h?f.cur:null;for(w(o),v(t,A,o),g&&(k.pushState&&r.length?h||k.pushState(i={},null,a):b.href=a),g=!0,h=!1,w(r),e=0;e<m.length;e++)m[e](a)}return p},on:function(a,b){return a===d?m.push(b):(l.push({h:a,c:b,cur:null}),a||n++),e},off:function(a,b){var c,f;if(a===d)for(c=m.length;c--;)m[c]===b&&m.splice(c,1);else for(a||b||(l=[]),c=l.length;c--;)f=l[c],f.h!==a||b&&f.c!==b||(l.splice(c,1),f.h||n--);return e}}}(window,location,document);